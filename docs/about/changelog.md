# 更新日志

## 版本说明

!!! warning ""
    KubeOperator 版本号命名规则为: v大版本.功能版本.Bug修复版本

!!! info "例如"
    * v3.0.1 是 v3.0.0 之后的Bug修复版本
    * v3.1.0 是 v3.0.0 之后的功能版本
    * 像其它优秀开源项目一样，KubeOperator 将每月发布一个功能版本，并同时维护 3 个功能版本。比如:

!!! info "例如"
    * 在 v3.3 发布前，我们会同时维护 v3.0、v3.1、v3.2
    * 在 v3.3 发布后，我们会同时维护 v3.1、v3.2、v3.3；v3.0 会停止维护

## v3.11.1
------------------------
2021年10月24日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.20.10、v1.18.20

!!! summary "功能优化"
    - KubePi 可视化管理面板版本升级至 v1.1.0

!!! success "Bug 修复"
    - 修复了添加主机时，大内存主机获取不到内存的问题
    - 修复了导入 KubeOperator 自建集群 APIServer 与 HAProxy 端口不一致的问题

## v3.11.0
------------------------
2021年10月14日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.20.10、v1.18.20

!!! info "新增功能"
    - 导入 KubeOperator 自建集群支持扩缩容、升级等 Day2 操作
    - 工具列表增加 [KubePi](https://github.com/KubeOperator/KubePi) 仪表盘工具

!!! summary "功能优化"
    - 初始化集群时，支持设置 master 节点是否可调度
    - 支持工具状态及 chart 仓库同步
    - 支持 Prometheus 工具启用后跳转
    - 工具列表增加详情信息展示
    - 添加存储类时，支持自定义回收策略
    - 集群、主机等列表页支持自定义排序
    - 主机列表页增加凭据信息（默认隐藏）
    - 创建 vcenter 可用区时，资源类型支持选择主机
    - 创建可用区时，自定义模版支持自定义凭据和端口
    - 部署计划、可用区和区域列表默认按照名称排序
    - 系统设置添加仓库时，支持设置 nexus 仓库密码
    - 运行时选择 docker 时，默认支持 live-restore
    - 添加集群配置预览时，手动集群节点超出后隐藏显示
    - 集群评分功能优化（polaris 版本升级至 v4.1.0）
    - 批量删除存储提供商时，增加状态判断
    - 集群 API 健康检查增加待解决状态
    - 集群删除逻辑优化

!!! success "Bug 修复"
    - 修复了 Webkubectl 弹出时显示 token 错误的问题
    - 修复了提交类按钮双击导致重复提交的问题
    - 修复了 openstack 集群创建可用区时，虚拟机没有创建在指定服务器的问题
    - 修复了发生网络闪断后，kobe 服务中锁未释放的问题
    - 修复了 Ubuntu 主机 kubectl 命令没有自动补全的问题
    - 修复了导入集群没有发送消息的问题
    - 修复了导入集群删除后，消息详情没有获取到集群名称的问题
    - 修复了区域、消息中心高级搜索报错的问题

!!! summary "组件更新"
    - K8s: v1.20.10
    - metrics-server: v0.5.0
    - harbor: v2.3.1
    - jenkins: v2.289.3

## v3.10.1
------------------------
2021年8月19日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.20.8、v1.18.20

!!! summary "功能优化"
    - 健康检查增加代理IP检测

!!! success "Bug 修复"
    - 修复了 service cidr 修改后创建集群没有生效的问题
    - 修复了使用中的仓库可以被删除的问题
    - 修复了项目管理员切换项目异常的问题
    - 修复了导入集群删除后没有接收到站内信的问题

## v3.10.0
------------------------
2021年8月12日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.20.8、v1.18.20

!!! info "新增功能"
    - 集群高可用部署支持 VIP
    - 集群节点扩容支持实时查看日志和错误重试
    - 集群节点支持强制删除

!!! summary "功能优化"
    - 支持修改非绑定状态的主机
    - 支持自定义 NodePort 端口范围和地址
    - 创建集群时支持设置 service CIDR
    - 集群节点扩容时同步设置 dns 缓存
    - 集群节点添加、删除时同步刷新节点 hosts 记录
    - Prometheus 服务类型修改为 NodePort
    - 导入集群支持设置架构信息
    - 实时同步集群状态
    - 集群备份逻辑优化
    - 集群诊断功能优化
    - 集群备份功能优化
    - 集群强制删除功能优化

!!! success "Bug 修复"
    - 修复了导入集群使用集群评分功能异常的问题
    - 修复了集群节点没有根据名称排序的问题
    - 修复部分编辑页面刷新后定位错误的问题

## v3.9.0
------------------------
2021年7月8日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.20.8、v1.18.20

!!! info "新增功能"
    - 集群节点操作系统支持 Ubuntu 18.04/20.04
    - 支持非 root 用户安装 K8s 集群
    - 支持自定义 Nexus 仓库端口

!!! summary "功能优化"
    - 升级 Docker 版本至 20.10.7
    - 针对多网卡主机，Calico 多网络支持 IP 网段设置
    - 优化主机、部署计划和备份账号授权逻辑
    - 项目管理员、集群管理员登录时集群列表取消项目显示
    - 删除项目权限绑定时，增加集群是否已绑定的判断
    - 优化主机名、用户名校验逻辑

!!! success "Bug 修复"
    - 修复了集群创建和扩容时，没有校验主机架构的问题
    - 修复了集群管理员的部分权限问题
    - 修复了驱散集群节点后获取不到集群版本的问题
    - 修复了启用工具时，可以选择已经被驱散的节点的问题
    - 修复了主机批量导入校验报错的问题
    - 修复了集群删除时资源未能成功解绑的问题

## v3.8.0
------------------------
2021年6月10日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.20.6、v1.18.18

!!! info "新增功能"
    - 支持 k8s v1.20.6 版本
    - 持久卷支持添加 nfs
    - 支持 gpu operator
    - 集群扩容操作支持添加 gpu 主机
    - 集群健康检查增加节点数量同步
    - 启用 docker-registry 增加登录认证（admin/kubeoperator）
    - server 日志支持输出到控制台并存储到文件

!!! summary "功能优化"
    - 支持直接跳转 nexus 仓库
    - 补全了绑定、解绑集群资源等操作日志
    - 去掉正常主机状态同步任务的日志打印
    - 优化了持久卷表单国际化显示
    - 优化删除持久卷的提示信息
    - 集群监控支持自定义时间搜索
    - 根据集群版本动态匹配 dashboard 和 coredns 版本
    - 点击集群详情、创建部署计划时增加了是否存在仓库的判断

!!! success "Bug 修复"
    - 解决存储提供商状态为失败时还能添加存储类的问题
    - 解决了添加 local volume 持久卷失败的问题
    - 解决了监控界面数据被覆盖的问题
    - 解决了项目管理员添加集群时默认项目显示错误的问题
    - 解决了集群升级任务中断后，重启服务状态仍然处于升级中的问题
    - 解决了创建集群时，容器网络设置不能恢复默认值的问题
    - 解决了 dns 缓存 与 Traefik 同时启用导致集群创建失败的问题
    - 解决了修改凭据明文显示的问题
    - 解决了仓库高级搜索页地址选项显示错误的问题
    - 解决了添加集群时，概览页面缺少部分信息的问题
    - 解决了项目管理员高级搜索结果匹配错误的问题

!!! summary "组件更新"
    - k8s: v1.20.6
    - calico: v3.18.4
    - traefik: v2.4.8
    - helm: v3.6.0
    - dashboard: v2.2.0
    - argo-cd: v2.0.3

## v3.7.2
------------------------
2021年5月23日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.20.4、v1.18.18

!!! success "Bug 修复"
    修复了 yum 仓库中部分 rpm 包缺失的问题

## v3.7.1
------------------------
2021年5月21日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.20.4、v1.18.18

!!! success "Bug 修复"
    - 解决了 v3.6.0 之前版本升级后，仓库信息无法编辑的问题
    - 解决了集群添加节点失败失败后，节点页面一直 loading 的问题
    - 解决了集群定时备份失败的问题
    - 解决了集群监控页面选择节点异常的问题
    - 解决了导入集群可以添加存储提供商的问题
    - 解决了集群导入、升级页面回退按钮缺失的问题

## v3.7.0
------------------------
2021年5月13日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.20.4、v1.18.18

!!! info "特别说明"
    - 使用 Vue 重构前端工程 Neeko，实现前后端分离
    - 优化、添加部分API
    - 优化权限管理模型

!!! summary "组件更新"
    - k8s: v1.20.4、v1.18.18
    - docker: 19.03.15

## v3.6.2
------------------------
2021年4月13日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.20.4

!!! success "Bug 修复"
    - 解决了 vSphere 可用区创建失败的问题
    - 解决了离线包中 Grafana 镜像缺失的问题

## v3.6.1
------------------------
2021年4月8日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.20.4

!!! info "新增功能"
    - 网络插件支持 Cilium
    - 持久化存储支持 Cinder CSI
    - 持久化存储支持 GlusterFS
    - 集群支持开启 NodeLocal DNS Cache

!!! summary "功能优化"
    - 优化了 K8s 集群不能跨大版本升级的提示信息

!!! success "Bug 修复"
    - 解决了在没有设置仓库的前提下，主机可以添加成功的问题

## v3.6.0
------------------------
2021年3月11日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.20.4

!!! info "新增功能"
    - 支持 k8s v1.20 版本
    - 支持 amd64 和 arm64 混合集群部署
    - arm64 架构支持 containerd 集成
    - vSphere CSI 插件集成
    - 集群监控页面重构

!!! summary "功能优化"
    - 主机列表支持批量刷新
    - 主机列表同步主机信息定时任务优化
    - 根据 CIDR 动态计算可支持的集群节点数量
    - 存储提供商删除操作同步删除集群中创建资源
    - 存储提供商状态同步
    - 版本管理详情页关联工具和持久化存储版本
    - 集群概览信息优化

!!! success "Bug 修复"
    - 解决了 OpenStack 环境中虚机创建失败的问题

## v3.5.2
------------------------
2021年2月7日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.18.15

!!! summary "功能优化"
    - 删除存储类操作添加到系统日志

!!! success "Bug 修复"
    - 解决了删除存储类失败的问题

## v3.5.1
------------------------
2021年2月5日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.18.15

!!! info "新增功能"
    - 支持集群工具升级
    - 支持多级加密
    - 集群部署支持自定义配置 yum 仓库

!!! summary "功能优化"
    - 支持集群强制删除
    - 支持存储卷和存储类删除
    - 主机批量导入功能优化
    - 集群添加节点功能优化
    - 创建存储类功能优化
    - 创建存储提供商任务状态实时同步
    - 网络插件安装提示信息国际化
    - 调用 kubernetes api 等操作添加到系统日志
    - 配置文件中密文存储工作密钥和密码

## v3.5.0
------------------------
2021年1月15日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.18.14 和 1.18.12

!!! info "新增功能"
    - 支持集群异常状态诊断及修复
    - 支持 Istio v1.8.0
    - 自动模式创建主机支持 IP 池
    - 支持自定义 Ansible 任务超时时间和并发参数
    - 版本管理支持上传 K8s 离线包
    - 支持 Grafana

!!! summary "功能优化"
    - 优化 K8s 集群的升级流程
    - 优化 K8s 集群创建时的选项
    - 优化用户密码加密方式
    - 优化集群 Namespace 的删除操作
    - 优化集群安装、升级时错误信息的显示
    - vSphere 模版支持多磁盘
    - 创建可用区时，vSphere Datastore 支持多选

!!! summary "组件更新"
    - k8s: v1.18.14
    - etcd: v3.4.14
    - containerd: 1.4.3

## v3.4.2
------------------------
2020年12月28日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.18.10 和 1.18.12

!!! info "功能优化"
    - 手动模式卸载集群时支持重试、查看日志
    - 优化新增用户密码强度校验
    - 优化 ansible 任务执行脚本
    - 支持 PasswordAuthentication 为 no 的 ssh 认证方式

!!! success "Bug 修复"
    - 解决了集群节点操作系统为 CentOS7.4 时，集群安装失败的问题
    - 解决了 FusionCompute 创建虚机失败的问题
    - 解决了 ssh 到安装有 helm3 的 master 节点提示 Warning 信息的问题
    - 解决了 arm64 离线包缺失 registry 镜像的问题

## v3.4.1
------------------------
2020年12月16日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.18.10 和 1.18.12

!!! info "新增功能"
    - 用户可自定义配置执行任务超时时间
    - 优化了容器运行时 systemd 参数配置

!!! success "Bug 修复"
    - 解决了多集群管理任务同步失败的问题
    - 解决了用户登录前后 ksessionid 未改变等安全问题

## v3.4.0
------------------------
2020年12月10日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.18.10 和 1.18.12

!!! info "新增功能"
    - 多集群管理（X-Pack）
    - GPU 支持
    - 系统操作日志
    - 集群日志支持 Loki
    - 集群备份支持 SFTP
    - 批量导入主机
    - 忘记密码
    - FusionCompute 支持默认模版
    - 应用商店增加 Kuboard、TensorFlow

!!! summary "功能优化"
    - 主机、备份账号页面可以直接授权到项目
    - arm64 集群支持 chartmuseum
    - 启用工具支持选择 namespace 和 node 节点
    - 手动模式状态为 Failed 的集群，删除操作时触发集群卸载脚本
    - 集群日志终端增加停止、开启按钮
    - 格式化显示创建集群错误信息
    - 优化集群脚本默认并发数量
    - 优化日期控件
    - 优化用户密码、用户邮箱等敏感数据显示方式
    - 上传文件控件国际化
    - 优化工具部署超时时间
    - 工具卸载时状态重置为销毁中
    - 优化文档、Rest Api等页面跳转方式
    - 优化集群创建时默认网络参数

!!! summary "组件更新"
    - k8s: v1.18.10, v1.18.12
    - containerd: 1.4.1
    - coredns: 1.8.0
    - flannel: v0.13.0
    - calico: v3.16.5
    - helm_v2: v2.17.0
    - helm_v3: v3.4.1

## v3.3.1
------------------------
2020年11月20日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.18.8 和 1.18.10

!!! success "Bug 修复"
    - 修复了升级后，原集群没有日志工具的问题
    - 修复了自动模式创建集群删除失败的问题

## v3.3.0
------------------------
2020年11月12日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.18.8 和 1.18.10

!!! info "新增功能"
    - FusionCompute 支持自动部署模式
    - 持久化存储支持 OceanStor
    - 集群日志，支持 EFK
    - 集群健康评估（X-Pack）
    - F5 对接（X-Pack）
    - 支持登录验证码
    - 支持动态管理 Kubernetes 及组件版本
    - 自动模式支持自定义 cpu、内存规格

!!! summary "功能优化"
    - 集群创建支持指定网卡信息、helm版本
    - 支持添加、删除 namespace
    - 集群事件支持启用、禁用 npd
    - REST API 开启 rbac 认证
    - 支持 session 和 jwt 两种认证方式

## v3.2.0
------------------------
2020年10月10日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.18.6 和 1.18.8

!!! info "新增功能"
    - 新增消息中心（X-Pack）
    - 支持邮箱、钉钉、企业微信告警（X-Pack）
    - 支持实时查看任务返回日志
    - 应用商店新增 Redmine

!!! summary "功能优化"
    - 优化大规模 Kubernetes 集群创建、扩容任务
    - 升级 nginx 和 ingress-nginx 版本，解决 CVE-2020-12440 安全漏洞

## v3.1.1
------------------------
2020年09月16日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.18.6 和 1.18.8

!!! success "Bug 修复"
    - 修复了添加持久卷时无法选择 exists 的问题
    - 修复了 kubernetes 集群升级失败后状态未更新的问题
    - 修复了离线包中缺失 kube-bench 镜像导致 CIS 扫描失败的问题
    - 修复了部分部署机由于环境变量缺失导致 docker-compose 安装失败的问题

## v3.1.0
------------------------
2020年09月10日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.18.6 和 1.18.8

!!! info "新增功能"
    - CIS 安全扫描
    - 自定义 Logo 和系统名称（X-Pack）
    - LDAP 对接（X-Pack）
    - Kubernetes 版本管理
    - 查看集群事件

!!! summary "功能优化"
    - 集群 etcd 定时备份和自定义恢复
    - 优化安装升级脚本
    - 优化部分 API 接口

## v3.0.3
------------------------
2020年08月31日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.18.3 和 1.18.4

!!! summary "功能优化"
    优化安装升级脚本

!!! success "Bug 修复"
    - 修复了自动模式创建主机失败的问题
    - 修复了失败状态的集群无法删除的问题

## v3.0.2
------------------------
2020年08月24日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.18.3 和 1.18.4

!!! summary "功能优化"
    - 优化部分 API 接口
    - 优化主机定时任务
    - 优化上传 VMware 镜像逻辑

!!! success "Bug 修复"
    - 修复了 OpenStack 校验失败的问题
    - 修复了 RHEL 操作系统 rpm 包缺失的问题
    - 修复了初始化状态的可用区依然可以添加到部署计划的问题
    - 修复了集群节点重启后，rook ceph osd pod 启动失败的问题
    - 修复了集群删除节点后项目资源没有修改的问题

## v3.0.1
------------------------
2020年08月18日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.18.3 和 1.18.4

!!! summary "功能优化"
    - 开放 REST API
    - 已有集群导入

!!! success "Bug 修复"
    - 修复了 kubeoperator_nginx 容器没有正常启动的问题
    - 修复了集群恢复时还可以进行备份操作的问题

## v3.0.0
------------------------
2020年08月13日

!!! info "支持 k8s 版本"
    支持的 k8s 版本是 1.18.3 和 1.18.4

!!! info "新增功能"
    - Go 语言重写
    - 架构解耦和优化
    - 支持在线部署模式
    - 支持已有集群导入
    - 集成 kubeadm
    - 支持 ARM64 架构
    - 开放 REST API
    - 国际化支持
